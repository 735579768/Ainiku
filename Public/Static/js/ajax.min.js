(function($){var data={_x:0,_y:0};$.fn.kldrag=function(options){var defaults={titleheight:50,space:false,spacestyle:""};var opts=$.extend(defaults,options);this.bind("mousedown",function(e){var xxx=$(this).offset().left;var yyy=$(this).offset().top;data._x=e.pageX-xxx;data._y=e.pageY-yyy;if(opts.titleheight===0||opts.titleheight>=data._y){$(this).css({zIndex:999999999,position:"absolute",left:xxx+"px",top:yyy+"px",margin:"0px"});if(opts.space){$("#divspace").remove();$(this).after('<div id="divspace" style="z-index:999;position:absolute;left:'+xxx+"px;top:"+yyy+"px;width:"+$(this).outerWidth()+"px;height:"+$(this).outerHeight()+"px;border:dashed 1px #f00;"+opts.spacestyle+'"></div>');}
$(this).css("cursor","move");}});this.bind("mousemove",function(e){if(opts.titleheight===0||opts.titleheight>=data._y){if(e.which===1){xx=e.pageX-data._x;yy=e.pageY-data._y;$(this).css({zIndex:999999,position:"absolute",left:xx+"px",top:yy+"px"});}}});this.bind("mouseup",function(){$(this).css("cursor","auto");$("#divspace").remove();});};})(jQuery);$(function(){window.ajaxhref=function(obj){obj.addClass("disabled");if(typeof arguments[2]!="undefined")reloadbool=arguments[2];if(typeof arguments[1]!="undefined")msgtime=arguments[1];url=obj.attr("href");if(typeof url=="undefined")url=obj.attr("url");$("body").append('<div id="klbg" class="bg">');$.ajax({type:"POST",url:url,success:function(da){topmsg(da,function(){obj.removeClass("disabled");});},dataType:"JSON"});return false;};window.ajaxform=function(thisobj,callback){thisobj.addClass("disabled");if(typeof arguments[2]!="undefined")reloadbool=arguments[2];if(typeof arguments[1]!="undefined")msgtime=arguments[1];try{if(typeof _before_post=="function")_before_post();if(typeof _before_func=="function")_before_func();var thisobj,obj,a,url;a="";formobj=thisobj.parents("form");formobj.submit(function(e){return false;});url=formobj.attr("action");postdata=formobj.serialize();a="{"+a+"}";b=eval("("+a+")");$("body").append('<div id="klbg" class="bg">');$.ajax({url:url,type:"POST",datatype:"JSON",data:postdata,success:function(da){topmsg(da,function(){thisobj.removeClass("disabled");if(typeof callback==="function"){callback(da);}});}});}catch(e){alert(e.name+": "+e.message);}};window.topmsg=function(da,callback){var str=typeof da==="string"?da:da.info;var uri=typeof da==="string"?"":da.url;var data={url:uri,info:str,msgtime:2};var msgtime=data.msgtime;$("body").css("posttion","relative");$("#topmsg").remove();var xiaolian=da.status=="0"?">_<":"o_0";$("body").append('<div id="topmsg" style="z-index:99999;padding:15px 20px;font-weight:bolder;text-align:center; color:#f00;display:block;position:fixed;top:0px; background:#fff; left:50%;border-radius: 10px;-webkit-box-shadow: 0px 4px 13px rgba(0,0,0,0.30);-moz-box-shadow: 0px 4px 13px rgba(0,0,0,0.30);box-shadow: 0px 4px 13px rgba(0,0,0,0.30);_left:45%;_position:absolute;_bottom:auto;_top:expression(eval(document.documentElement.scrollTop));">'+xiaolian+" ，"+data.info+"<span>,"+msgtime+"</span></div>");$("#topmsg").css({marginLeft:"-"+$("#topmsg").outerWidth()/2+"px",top:"-"+$("#topmsg").outerHeight()+"px"});$("#topmsg").stop(true).animate({top:$("#topmsg").outerHeight()/2+20+"px"},200,function(){$("#topmsg").stop(true).animate({top:"20px"},100);});if(da.status=="0"){$("#topmsg").css({background:"#ff6666",color:"#ffffff"});}else{$("#topmsg").css({background:"#4bbd00",color:"#ffffff"});}
window.msgtimeid=setInterval(function(){if(msgtime>1){$("#topmsg span").html(","+ --msgtime);}else{clearInterval(msgtimeid);$("#topmsg").stop(true).animate({top:$("#topmsg").outerHeight()/2+"px"},100,function(){$("#topmsg").stop(true).animate({top:"-"+$("#topmsg").outerHeight()+"px",opacity:0},200,function(){$("#topmsg").remove();$("#klbg").remove();$(".disabled").removeClass("disabled");if(data.url!=""&&data.url!="undefined"){window.location=data.url;}
if(typeof callback=="function"){callback(da);}
if(typeof _after_post=="function"){_after_post(da);}
if(typeof _after_func=="function"){_after_func(da);}});});}},1e3);};$(".ajax-post").bind("click",function(){$(this).addClass("disabled");ajaxform($(this));});$(".ajax-href").bind("click",function(){$(this).addClass("disabled");return ajaxhref($(this));});$(".ajax-href-del").bind("click",function(){if(!confirm("确定此操作吗?"))return false;$(this).addClass("disabled");return ajaxhref($(this));});$(".ajax-blur").bind("blur",function(){var id1=$(this).attr("data-id");var table1=$(this).attr("data-table");var field1=$(this).attr("data-field");var value1=$(this).val();$.ajax({type:"POST",url:ainiku.updatefield,data:{id:id1,table:table1,field:field1,value:value1},success:function(da){$.myMsg.msg({content:da.info,bg:false,shijian:1});}});});window.dialogAjax=function(url,title,callback){title=title?title:"";$.get(url,function(data){$("body").append('<div id="dialog-wrap"><div class="bg"></div><table class="dialog" id="dialog" cellpadding="0" cellspacing="0"><tr><td class="t_l"></td><td class="t_c"></td><td class="t_r"></td></tr><tr><td class="m_l"></td><td class="m_c">  <div class="bm">    <div class="bm_h cl"><span><a href="javascript:;" class="flbc" id="dialog-close" title="关闭">关闭</a></span><h2 class="dialogh2">'+title+'</h2></div><div class="bm_c" id="dialog-con">'+data+'</div></div></td><td class="m_r"></td></tr><tr><td class="b_l"></td><td class="b_c"></td><td class="b_r"></td></tr></table></div>');var dialog=$("#dialog");dialog.kldrag();$("#dialog-close").click(function(e){$("#dialog-wrap").remove();});var w=dialog.width();var h=dialog.height();dialog.css({marginTop:"-"+h/2+"px",marginLeft:"-"+w/2+"px"});if(typeof callback==="function"){callback(data);}});};window.dialogsubmit=function(obj){ajaxform($(obj),function(da){if(da.status===1){$("#dialog").remove();}});};$(".yn").each(function(index,element){var da=parseInt($(this).attr("data-value"));if(da===1){$(this).addClass("y");}else{$(this).addClass("n");}
$(this).click(function(e){var _this=$(this);var data1=parseInt($(this).attr("data-value"));var table1=$(this).attr("data-table");var field1=$(this).attr("data-field");var id1=$(this).attr("data-id");data1=data1?0:1;if(data1!==""&&table1!==""&&field1!==""&&id1!==""){$.ajax({type:"POST",data:{id:id1,table:table1,field:field1,value:data1},url:ainiku.updatefield,success:function(da){if(da.status=="0"){topmsg(da,1,true);}else{if(_this.hasClass("y")){_this.attr("data-value",0);_this.removeClass("y");_this.addClass("n");}else{_this.attr("data-value",1);_this.removeClass("n");_this.addClass("y");}}}});}});});});function writeCookie(name,value,hours){var expire="";if(hours!=null){expire=new Date(new Date().getTime()+hours*36e5);expire="; expires="+expire.toGMTString();}
document.cookie=name+"="+escape(value)+expire;}
function readCookie(name){var cookieValue="";var search=name+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(search);if(offset!=-1){offset+=search.length;end=document.cookie.indexOf(";",offset);if(end==-1)end=document.cookie.length;cookieValue=unescape(document.cookie.substring(offset,end));}}
return cookieValue;}